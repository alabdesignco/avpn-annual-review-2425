(function(){"use strict";const v=()=>{const a=new Lenis;return a.on("scroll",ScrollTrigger.update),gsap.ticker.add(t=>{a.raf(t*1e3)}),gsap.ticker.lagSmoothing(0),a},b=(a="img")=>new Promise(t=>{imagesLoaded(document.querySelectorAll(a),{background:!0},t)}),A=()=>{if(!document.querySelector(".section_home-header .home-header_wrapper"))return;class t{constructor(){this.dom=document.querySelector(".section_home-header"),this.grid=document.querySelector(".home-header_wrapper"),this.products=[...document.querySelectorAll(".home-header_image-wrapper")],this.heading=document.querySelector(".home-header_heading"),this.navbar=document.querySelector(".navbar_component"),this.isDragging=!1}init(){this.intro()}intro(){this.centerGrid(),this.setupSplitText();const e=gsap.timeline();e.set(this.dom,{scale:.5}),e.set(this.products,{scale:.5,opacity:0}),e.set(this.navbar,{y:-100,autoAlpha:0}),e.from(this.headingChars,{yPercent:100,autoAlpha:0,duration:2,ease:"expo.inOut",stagger:.02}),e.to(this.products,{scale:1,opacity:1,duration:.6,ease:"power3.out",stagger:{amount:1.2,from:"random"}}),e.to(this.dom,{scale:1,duration:1.2,ease:"power3.inOut"}),e.to(this.navbar,{y:0,autoAlpha:1,duration:.8,ease:"power3.out"},"-=0.4"),e.call(()=>{this.setupDraggable(),this.addEvents(),this.observeProducts()})}setupSplitText(){this.heading&&(this.splitText=SplitText.create(this.heading,{type:"chars",mask:"chars"}),this.headingChars=this.splitText.chars)}centerGrid(){const e=this.grid.offsetWidth,r=this.grid.offsetHeight,n=window.innerWidth,m=window.innerHeight,l=(n-e)/2,g=(m-r)/2;gsap.set(this.grid,{x:l,y:g})}setupDraggable(){this.dom.classList.add("--is-loaded"),this.draggable=Draggable.create(this.grid,{type:"x,y",bounds:{minX:-(this.grid.offsetWidth-window.innerWidth)-200,maxX:200,minY:-(this.grid.offsetHeight-window.innerHeight)-100,maxY:100},inertia:!0,allowEventDefault:!0,edgeResistance:.9,onDragStart:()=>{this.isDragging=!0,this.grid.classList.add("--is-dragging")},onDragEnd:()=>{this.isDragging=!1,this.grid.classList.remove("--is-dragging")}})[0]}addEvents(){window.addEventListener("resize",()=>{this.updateBounds()})}updateBounds(){this.draggable&&(this.draggable.vars.bounds={minX:-(this.grid.offsetWidth-window.innerWidth)-50,maxX:50,minY:-(this.grid.offsetHeight-window.innerHeight)-50,maxY:50})}observeProducts(){const e=new IntersectionObserver(r=>{r.forEach(n=>{n.isIntersecting?gsap.to(n.target,{scale:1,opacity:1,duration:.5,ease:"power2.out"}):gsap.to(n.target,{opacity:0,scale:.5,duration:.5,ease:"power2.in"})})},{root:null,threshold:.1});this.products.forEach(r=>{e.observe(r)})}}const i=new t;b(".grid img").then(()=>{i.init(),document.body.classList.remove("loading")})},S=()=>{document.querySelectorAll(".horizontal-scroll-section_wrapper").forEach(a=>{const t=a.querySelector(".horizontal-scroll-section_track"),i=[1,2,3,4].map(r=>a.querySelector(`.foreword-content-accent_wrapper.is-${r}`)).filter(Boolean),p=()=>{a.style.height=`calc(${t.offsetWidth}px + 100vh)`};p(),ScrollTrigger.refresh(),window.addEventListener("resize",p),gsap.set(i,{scale:0,transformOrigin:"center"});const e=gsap.timeline({scrollTrigger:{trigger:a,start:"top top",end:"bottom bottom",scrub:!0},defaults:{ease:"power2.out"}});e.to(t,{xPercent:-100,ease:"none"},0),i.forEach((r,n)=>{const m=n/(i.length-1||1);e.to(r,{scale:1,duration:.3},m*.7)})})},E=()=>{document.querySelectorAll('[data-sticky-title="wrap"]').forEach(t=>{const i=Array.from(t.querySelectorAll('[data-sticky-title="heading"]')),p=Array.from(t.querySelectorAll(".bg-shape img")),e=gsap.timeline({scrollTrigger:{trigger:t,start:"top 40%",end:"bottom bottom",scrub:!0}}),r=.7,n=.7,m=.15;p.forEach((l,g)=>{g===0?gsap.set(l,{autoAlpha:1,scale:1}):gsap.set(l,{autoAlpha:0,scale:1.1})}),i.forEach((l,g)=>{const y=gsap.timeline();l.setAttribute("aria-label",l.textContent);const s=new SplitText(l,{type:"words,chars"});s.words.forEach(h=>h.setAttribute("aria-hidden","true")),gsap.set(l,{visibility:"visible"});const o=t.querySelector(`.bg-shape.is-${g+1} img`);if(g===0)y.set(o,{autoAlpha:1,scale:1},0);else{const h=t.querySelector(`.bg-shape.is-${g} img`);y.to(h,{autoAlpha:0,scale:1.1,duration:.8,ease:"power2.out"},0),y.fromTo(o,{autoAlpha:0,scale:1.1},{autoAlpha:1,scale:1,duration:.8,ease:"power2.out"},.4)}y.from(s.chars,{autoAlpha:0,stagger:{amount:r,from:"start"},duration:r},g===0?0:n*.3),g<i.length-1&&y.to(s.chars,{autoAlpha:0,stagger:{amount:n,from:"end"},duration:n}),g===0?e.add(y):e.add(y,`-=${m}`)})})},C=()=>{const a=[{cause:"Education",count:396,percent:62.66},{cause:"Climate Action & Environment",count:385,percent:60.92},{cause:"Livelihood and Poverty Alleviation",count:350,percent:55.38},{cause:"Health",count:333,percent:52.69},{cause:"Employability",count:243,percent:38.45},{cause:"Gender",count:260,percent:41.14},{cause:"Financial Inclusion",count:232,percent:36.71},{cause:"Agriculture",count:226,percent:35.76},{cause:"Energy",count:193,percent:30.54},{cause:"Water & Sanitation & Hygiene",count:185,percent:29.27},{cause:"Nutrition",count:143,percent:22.63},{cause:"Arts & Culture",count:132,percent:20.89},{cause:"Governance",count:130,percent:20.57},{cause:"Conservation",count:129,percent:20.41},{cause:"Ageing",count:109,percent:17.25},{cause:"Affordable Housing",count:105,percent:16.61}],t=e=>getComputedStyle(document.documentElement).getPropertyValue(e).trim(),i={Education:t("--color-education"),"Climate Action & Environment":t("--color-climate"),"Livelihood and Poverty Alleviation":t("--color-livelihood"),Health:t("--color-health"),Employability:t("--color-employability"),Gender:t("--color-gender"),"Financial Inclusion":t("--color-financial-inclusion"),Agriculture:t("--color-agriculture"),Energy:t("--color-energy"),"Water & Sanitation & Hygiene":t("--color-water"),Nutrition:t("--color-nutrition"),"Arts & Culture":t("--color-arts"),Governance:t("--color-governance"),Conservation:t("--color-conservation"),Ageing:t("--color-aging"),"Affordable Housing":t("--color-affordable-housing")},p=()=>{const r=document.querySelector(".supported-chart").offsetWidth,n=r,m=r,l=r*.15;d3.select(".supported-chart svg").remove();const g=d3.select(".supported-chart").append("svg").attr("viewBox",`0 0 ${n} ${m}`).attr("preserveAspectRatio","xMidYMid meet").style("width","100%").style("height","100%").append("g").attr("transform",`translate(${n/2},${m/2})`),y=d3.pie().sort(null).value(1);d3.arc().innerRadius(l).outerRadius(d=>l+d.data.percent*r*.003).cornerRadius(10).padAngle(.03);const s=g.selectAll("path").data(y(a)).enter().append("path").attr("fill",d=>i[d.data.cause]||"#ccc").attr("d",d3.arc().innerRadius(l).outerRadius(l)).attr("stroke","#fff").attr("stroke-width",2).style("cursor","pointer");s.transition().delay((d,c)=>c*100).duration(800).ease(d3.easeCubicOut).attrTween("d",function(d){const c=d3.interpolate(l,l+d.data.percent*r*.003);return function(u){return d3.arc().innerRadius(l).outerRadius(c(u)).cornerRadius(10).padAngle(.03)(d)}});const o=g.append("g").attr("class","supported-chart_center-text").style("pointer-events","none");o.append("text").attr("class","center-cause").attr("y",-10).attr("opacity",0).style("font-size",`${r*.018}px`).style("font-weight","700").style("fill","#000"),o.append("text").attr("class","center-count").attr("y",r*.025).attr("opacity",0).style("font-size",`${r*.014}px`).style("fill","#000"),o.append("text").attr("class","center-percent").attr("y",r*.05).attr("opacity",0).style("font-size",`${r*.014}px`).style("font-weight","700").style("fill","#000"),s.on("mouseover",function(d,c){g.selectAll("path").transition().duration(200).style("opacity",.3),d3.select(this).transition().duration(200).style("opacity",1),o.select(".center-cause").text(c.data.cause).transition().duration(200).style("opacity",1),o.select(".center-count").text(`Count: ${c.data.count}`).transition().duration(200).style("opacity",1),o.select(".center-percent").text(`${c.data.percent.toFixed(2)}%`).transition().duration(200).style("opacity",1)}).on("mouseout",function(){g.selectAll("path").transition().duration(200).style("opacity",1),o.selectAll("text").transition().duration(200).style("opacity",0)}),document.querySelectorAll(".supported-chart_legend-color").forEach(d=>{const c=parseInt(d.dataset.index),u=a[c]?.cause;if(!u)return;const f=i[u];f&&(d.style.backgroundColor=f)});const h=g.selectAll("path");document.querySelectorAll(".supported-chart_legend-item").forEach(d=>{const c=parseInt(d.querySelector(".supported-chart_legend-color").dataset.index);d.addEventListener("mouseenter",()=>{h.transition().duration(200).style("opacity",.3),d3.select(h.nodes()[c]).transition().duration(200).style("opacity",1);const u=a[c];o.select(".center-cause").text(u.cause).transition().duration(200).style("opacity",1),o.select(".center-count").text(`Count: ${u.count}`).transition().duration(200).style("opacity",1),o.select(".center-percent").text(`${u.percent.toFixed(2)}%`).transition().duration(200).style("opacity",1)}),d.addEventListener("mouseleave",()=>{h.transition().duration(200).style("opacity",1),o.selectAll("text").transition().duration(200).style("opacity",0)})})};p(),window.addEventListener("resize",p)},T=()=>{const a={name:"Beneficiary Communities",children:[{name:"Children & youths",value:433,percent:68.48},{name:"Women & girls",value:413,percent:65.35},{name:"People in poverty",value:397,percent:62.82},{name:"Environment",value:306,percent:48.42},{name:"People without employment",value:257,percent:40.67},{name:"People with disabilities",value:208,percent:32.91},{name:"Elderly",value:198,percent:31.33},{name:"People with medical needs",value:198,percent:31.33},{name:"Ethnic minorities",value:182,percent:28.8},{name:"Immigrants & asylum seekers & refugees",value:112,percent:17.72},{name:"Offenders & re-offenders",value:47,percent:7.44}]},t=document.querySelector(".beneficiary-treemap"),i=t.clientWidth||1e3,p=t.clientHeight||600,e=8;t.innerHTML="";const r=d3.select(t).append("svg").attr("viewBox",[0,0,i,p]).style("width","100%").style("height","100%"),n={"Children & youths":"#00B3AD","Women & girls":"#F17C38","People in poverty":"#FED452",Environment:"#ADD5E0","People without employment":"#4AC1BE","People with disabilities":"#002943",Elderly:"#F59D6A","People with medical needs":"#FEE07E","Ethnic minorities":"#86D1D1","Immigrants & asylum seekers & refugees":"#80BDB4","Offenders & re-offenders":"#F2948C"},m=d3.hierarchy(a).sum(s=>s.value).sort((s,o)=>o.value-s.value);d3.treemap().tile(d3.treemapBinary).size([i,p]).paddingInner(e).round(!0)(m);const l=r.selectAll("g").data(m.leaves()).join("g").attr("transform",s=>`translate(${s.x0},${s.y0})`).style("cursor","pointer"),g=s=>{const o=d3.color(s);return .2126*(o.r/255)+.7152*(o.g/255)+.0722*(o.b/255)>.6?"#002943":"#ffffff"},y=(s,o)=>{s.each(function(){const h=d3.select(this),d=h.text().split(/\s+/).reverse();let c,u=[],f=0;const H=1.1,x=h.attr("y");let w=h.text(null).append("tspan").attr("x",10).attr("y",x);for(;c=d.pop();)u.push(c),w.text(u.join(" ")),w.node().getComputedTextLength()>o&&(u.pop(),w.text(u.join(" ")),u=[c],w=h.append("tspan").attr("x",10).attr("y",x).attr("dy",`${++f*H}em`).text(c))})};l.each(function(s){const o=d3.select(this),h=n[s.data.name]||"#ccc",d=g(h),c=s.x1-s.x0,u=s.y1-s.y0;o.append("rect").attr("fill",h).attr("rx",10).attr("ry",10).attr("width",c).attr("height",u).style("transition","transform 0.25s ease, filter 0.25s ease").style("filter","drop-shadow(0 1px 2px rgba(0,0,0,0.05))"),o.on("mouseenter",()=>{o.raise().select("rect").style("transform","scale(1.05)").style("filter","drop-shadow(0 4px 8px rgba(0,0,0,0.15))")}).on("mouseleave",()=>{o.select("rect").style("transform","scale(1)").style("filter","drop-shadow(0 1px 2px rgba(0,0,0,0.05))")});const f=o.append("text").attr("x",10).attr("y",20).attr("fill",d).attr("font-size","13px").attr("font-weight",600).text(s.data.name).call(y,c-16);f.node().getBBox().height>u*.6&&f.style("display","none"),u>40&&c>80&&o.append("text").attr("x",c-10).attr("y",u-10).attr("text-anchor","end").attr("fill",d).attr("font-size","12px").text(`${s.data.percent.toFixed(2)}%`)})},q=()=>{const a=document.querySelector(".section_new");if(!a)return;const t=a.querySelector(".new_pin-height"),i=a.querySelector(".new_layout"),p=a.querySelectorAll(".new-paragraph_item");if(!t||!i||p.length===0)return;const e=Array.from(p).map(n=>new SplitText(n,{type:"words",wordsClass:"word",mask:"words"}));gsap.set(e.map(n=>n.words),{yPercent:100}),ScrollTrigger.create({trigger:t,start:"top top",end:"bottom bottom",pin:i});const r=gsap.timeline({scrollTrigger:{trigger:t,start:"top top",end:"bottom bottom",scrub:!0}});e.forEach((n,m)=>{r.to(n.words,{yPercent:0,duration:1,stagger:.2,ease:"power4.out"},m>0?"+=0.5":0)})},_=()=>{const a=document.querySelector(".section_word-break"),t=document.querySelector(".section_word-break .word-break-text"),i=new SplitText(t,{type:"words, chars",smartWrap:!0,wordsClass:"word",charsClass:"char"}),p=i.chars;i.words;const e=t.clientWidth-document.body.clientWidth,r=gsap.to(t,{x:-e,ease:"none",scrollTrigger:{trigger:".section_word-break .word-break_container",pin:!0,end:"+="+e,scrub:!0}});gsap.from(a,{ease:"power1.out",scrollTrigger:{trigger:".section_word-break .word-break_container",start:"top top",end:"+=200",scrub:!0}}),p.forEach(n=>{gsap.from(n,{yPercent:(Math.random()-.5)*400,rotation:(Math.random()-.5)*60,ease:"elastic.out(1.2, 1)",scrollTrigger:{trigger:n,containerAnimation:r,start:"left 90%",end:"left 10%",scrub:.5}})})};function k(){document.querySelectorAll("[data-highlight-text]").forEach(t=>{const i=t.getAttribute("data-highlight-scroll-start")||"top 90%",p=t.getAttribute("data-highlight-scroll-end")||"center 40%",e=t.getAttribute("data-highlight-fade")||.2,r=t.getAttribute("data-highlight-stagger")||.1;new SplitText(t,{type:"words, chars",autoSplit:!0,onSplit(n){return gsap.context(()=>{gsap.timeline({scrollTrigger:{scrub:!0,trigger:t,start:i,end:p}}).from(n.chars,{autoAlpha:e,stagger:r,ease:"linear"})})}})})}gsap.registerPlugin(ScrollTrigger,Observer,SplitText,Draggable),v(),document.addEventListener("DOMContentLoaded",()=>{A(),S(),E(),C(),T(),q(),_(),k()})})();
