(function(){"use strict";const x=()=>{const s=new Lenis;return s.on("scroll",ScrollTrigger.update),gsap.ticker.add(t=>{s.raf(t*1e3)}),gsap.ticker.lagSmoothing(0),s},v=(s="img")=>new Promise(t=>{imagesLoaded(document.querySelectorAll(s),{background:!0},t)}),A=()=>{if(!document.querySelector(".section_home-header .home-header_wrapper"))return;class t{constructor(){this.dom=document.querySelector(".section_home-header"),this.grid=document.querySelector(".home-header_wrapper"),this.products=[...document.querySelectorAll(".home-header_image-wrapper")],this.heading=document.querySelector(".home-header_heading"),this.navbar=document.querySelector(".navbar_component"),this.taglines=[...document.querySelectorAll(".tagline")],this.isDragging=!1}init(){this.intro()}intro(){this.centerGrid(),this.setupSplitText();const e=gsap.timeline();e.set(this.dom,{scale:.5}),e.set(this.products,{scale:.5,opacity:0}),this.taglines.length>0&&e.set(this.taglines,{yPercent:100,autoAlpha:0}),e.set(this.navbar,{y:-100,autoAlpha:0}),e.from(this.headingChars,{yPercent:100,autoAlpha:0,duration:2,ease:"expo.inOut",stagger:.02}),this.taglines.length>0&&e.from(this.taglines,{yPercent:100,autoAlpha:0,duration:.8,ease:"expo.out",stagger:.15},"-=1.5"),e.to(this.products,{scale:1,opacity:1,duration:.6,ease:"power3.out",stagger:{amount:1.2,from:"random"}}),e.to(this.dom,{scale:1,duration:1.2,ease:"power3.inOut"}),e.to(this.navbar,{y:0,autoAlpha:1,duration:.8,ease:"power3.out"},"-=0.4"),e.call(()=>{this.setupDraggable(),this.addEvents(),this.observeProducts()})}setupSplitText(){this.heading&&(this.splitText=SplitText.create(this.heading,{type:"chars",mask:"chars"}),this.headingChars=this.splitText.chars)}centerGrid(){const e=this.grid.offsetWidth,o=this.grid.offsetHeight,a=window.innerWidth,y=window.innerHeight,c=(a-e)/2,d=(y-o)/2;gsap.set(this.grid,{x:c,y:d})}setupDraggable(){this.dom.classList.add("--is-loaded"),this.draggable=Draggable.create(this.grid,{type:"x,y",bounds:{minX:-(this.grid.offsetWidth-window.innerWidth)-200,maxX:200,minY:-(this.grid.offsetHeight-window.innerHeight)-100,maxY:100},inertia:!0,allowEventDefault:!0,edgeResistance:.9,onDragStart:()=>{this.isDragging=!0,this.grid.classList.add("--is-dragging")},onDragEnd:()=>{this.isDragging=!1,this.grid.classList.remove("--is-dragging")}})[0]}addEvents(){window.addEventListener("resize",()=>{this.updateBounds()})}updateBounds(){this.draggable&&(this.draggable.vars.bounds={minX:-(this.grid.offsetWidth-window.innerWidth)-50,maxX:50,minY:-(this.grid.offsetHeight-window.innerHeight)-50,maxY:50})}observeProducts(){const e=new IntersectionObserver(o=>{o.forEach(a=>{a.isIntersecting?gsap.to(a.target,{scale:1,opacity:1,duration:.5,ease:"power2.out"}):gsap.to(a.target,{opacity:0,scale:.5,duration:.5,ease:"power2.in"})})},{root:null,threshold:.1});this.products.forEach(o=>{e.observe(o)})}}const i=new t;v(".grid img").then(()=>{i.init(),document.body.classList.remove("loading")})},S=()=>{document.querySelectorAll(".horizontal-scroll-section_wrapper").forEach(s=>{const t=s.querySelector(".horizontal-scroll-section_track"),i=[1,2,3,4].map(o=>s.querySelector(`.foreword-content-accent_wrapper.is-${o}`)).filter(Boolean),h=()=>{s.style.height=`calc(${t.offsetWidth}px + 100vh)`};h(),ScrollTrigger.refresh(),window.addEventListener("resize",h),gsap.set(i,{scale:0,transformOrigin:"center"});const e=gsap.timeline({scrollTrigger:{trigger:s,start:"top top",end:"bottom bottom",scrub:!0},defaults:{ease:"power2.out"}});e.to(t,{xPercent:-100,ease:"none"},0),i.forEach((o,a)=>{const y=a/(i.length-1||1);e.to(o,{scale:1,duration:.3},y*.7)})})},E=()=>{document.querySelectorAll('[data-sticky-title="wrap"]').forEach(t=>{const i=Array.from(t.querySelectorAll('[data-sticky-title="heading"]')),h=Array.from(t.querySelectorAll(".bg-shape img")),e=gsap.timeline({scrollTrigger:{trigger:t,start:"top 40%",end:"bottom bottom",scrub:!0}}),o=.7,a=.7,y=.15;h.forEach((c,d)=>{d===0?gsap.set(c,{autoAlpha:1,scale:1}):gsap.set(c,{autoAlpha:0,scale:1.1})}),i.forEach((c,d)=>{const m=gsap.timeline();c.setAttribute("aria-label",c.textContent);const r=new SplitText(c,{type:"words,chars"});r.words.forEach(u=>u.setAttribute("aria-hidden","true")),gsap.set(c,{visibility:"visible"});const n=t.querySelector(`.bg-shape.is-${d+1} img`);if(d===0)m.set(n,{autoAlpha:1,scale:1},0);else{const u=t.querySelector(`.bg-shape.is-${d} img`);m.to(u,{autoAlpha:0,scale:1.1,duration:.8,ease:"power2.out"},0),m.fromTo(n,{autoAlpha:0,scale:1.1},{autoAlpha:1,scale:1,duration:.8,ease:"power2.out"},.4)}m.from(r.chars,{autoAlpha:0,stagger:{amount:o,from:"start"},duration:o},d===0?0:a*.3),d<i.length-1&&m.to(r.chars,{autoAlpha:0,stagger:{amount:a,from:"end"},duration:a}),d===0?e.add(m):e.add(m,`-=${y}`)})})},C=()=>{const s=[{cause:"Education",count:396,percent:62.66},{cause:"Climate Action & Environment",count:385,percent:60.92},{cause:"Livelihood and Poverty Alleviation",count:350,percent:55.38},{cause:"Health",count:333,percent:52.69},{cause:"Employability",count:243,percent:38.45},{cause:"Gender",count:260,percent:41.14},{cause:"Financial Inclusion",count:232,percent:36.71},{cause:"Agriculture",count:226,percent:35.76},{cause:"Energy",count:193,percent:30.54},{cause:"Water & Sanitation & Hygiene",count:185,percent:29.27},{cause:"Nutrition",count:143,percent:22.63},{cause:"Arts & Culture",count:132,percent:20.89},{cause:"Governance",count:130,percent:20.57},{cause:"Conservation",count:129,percent:20.41},{cause:"Ageing",count:109,percent:17.25},{cause:"Affordable Housing",count:105,percent:16.61}],t=e=>getComputedStyle(document.documentElement).getPropertyValue(e).trim(),i={Education:t("--color-education"),"Climate Action & Environment":t("--color-climate"),"Livelihood and Poverty Alleviation":t("--color-livelihood"),Health:t("--color-health"),Employability:t("--color-employability"),Gender:t("--color-gender"),"Financial Inclusion":t("--color-financial-inclusion"),Agriculture:t("--color-agriculture"),Energy:t("--color-energy"),"Water & Sanitation & Hygiene":t("--color-water"),Nutrition:t("--color-nutrition"),"Arts & Culture":t("--color-arts"),Governance:t("--color-governance"),Conservation:t("--color-conservation"),Ageing:t("--color-aging"),"Affordable Housing":t("--color-affordable-housing")},h=()=>{const o=document.querySelector(".supported-chart").offsetWidth,a=o,y=o,c=o*.15;d3.select(".supported-chart svg").remove();const d=d3.select(".supported-chart").append("svg").attr("viewBox",`0 0 ${a} ${y}`).attr("preserveAspectRatio","xMidYMid meet").style("width","100%").style("height","100%").append("g").attr("transform",`translate(${a/2},${y/2})`),m=d3.pie().sort(null).value(1);d3.arc().innerRadius(c).outerRadius(p=>c+p.data.percent*o*.003).cornerRadius(10).padAngle(.03);const r=d.selectAll("path").data(m(s)).enter().append("path").attr("fill",p=>i[p.data.cause]||"#ccc").attr("d",d3.arc().innerRadius(c).outerRadius(c)).attr("stroke","#fff").attr("stroke-width",2).style("cursor","pointer");r.transition().delay((p,l)=>l*100).duration(800).ease(d3.easeCubicOut).attrTween("d",function(p){const l=d3.interpolate(c,c+p.data.percent*o*.003);return function(g){return d3.arc().innerRadius(c).outerRadius(l(g)).cornerRadius(10).padAngle(.03)(p)}});const n=d.append("g").attr("class","supported-chart_center-text").style("pointer-events","none");n.append("text").attr("class","center-cause").attr("y",-10).attr("opacity",0).style("font-size",`${o*.018}px`).style("font-weight","700").style("fill","#000"),n.append("text").attr("class","center-count").attr("y",o*.025).attr("opacity",0).style("font-size",`${o*.014}px`).style("fill","#000"),n.append("text").attr("class","center-percent").attr("y",o*.05).attr("opacity",0).style("font-size",`${o*.014}px`).style("font-weight","700").style("fill","#000"),r.on("mouseover",function(p,l){d.selectAll("path").transition().duration(200).style("opacity",.3),d3.select(this).transition().duration(200).style("opacity",1),n.select(".center-cause").text(l.data.cause).transition().duration(200).style("opacity",1),n.select(".center-count").text(`Count: ${l.data.count}`).transition().duration(200).style("opacity",1),n.select(".center-percent").text(`${l.data.percent.toFixed(2)}%`).transition().duration(200).style("opacity",1)}).on("mouseout",function(){d.selectAll("path").transition().duration(200).style("opacity",1),n.selectAll("text").transition().duration(200).style("opacity",0)}),document.querySelectorAll(".supported-chart_legend-color").forEach(p=>{const l=parseInt(p.dataset.index),g=s[l]?.cause;if(!g)return;const f=i[g];f&&(p.style.backgroundColor=f)});const u=d.selectAll("path");document.querySelectorAll(".supported-chart_legend-item").forEach(p=>{const l=parseInt(p.querySelector(".supported-chart_legend-color").dataset.index);p.addEventListener("mouseenter",()=>{u.transition().duration(200).style("opacity",.3),d3.select(u.nodes()[l]).transition().duration(200).style("opacity",1);const g=s[l];n.select(".center-cause").text(g.cause).transition().duration(200).style("opacity",1),n.select(".center-count").text(`Count: ${g.count}`).transition().duration(200).style("opacity",1),n.select(".center-percent").text(`${g.percent.toFixed(2)}%`).transition().duration(200).style("opacity",1)}),p.addEventListener("mouseleave",()=>{u.transition().duration(200).style("opacity",1),n.selectAll("text").transition().duration(200).style("opacity",0)})})};h(),window.addEventListener("resize",h)},T=()=>{const s={name:"Beneficiary Communities",children:[{name:"Children & youths",value:433,percent:68.48},{name:"Women & girls",value:413,percent:65.35},{name:"People in poverty",value:397,percent:62.82},{name:"Environment",value:306,percent:48.42},{name:"People without employment",value:257,percent:40.67},{name:"People with disabilities",value:208,percent:32.91},{name:"Elderly",value:198,percent:31.33},{name:"People with medical needs",value:198,percent:31.33},{name:"Ethnic minorities",value:182,percent:28.8},{name:"Immigrants & asylum seekers & refugees",value:112,percent:17.72},{name:"Offenders & re-offenders",value:47,percent:7.44}]},t=document.querySelector(".beneficiary-treemap"),i=t.clientWidth||1e3,h=t.clientHeight||600,e=8;t.innerHTML="";const o=d3.select(t).append("svg").attr("viewBox",[0,0,i,h]).style("width","100%").style("height","100%"),a={"Children & youths":"#00B3AD","Women & girls":"#F17C38","People in poverty":"#FED452",Environment:"#ADD5E0","People without employment":"#4AC1BE","People with disabilities":"#002943",Elderly:"#F59D6A","People with medical needs":"#FEE07E","Ethnic minorities":"#86D1D1","Immigrants & asylum seekers & refugees":"#80BDB4","Offenders & re-offenders":"#F2948C"},y=d3.hierarchy(s).sum(r=>r.value).sort((r,n)=>n.value-r.value);d3.treemap().tile(d3.treemapBinary).size([i,h]).paddingInner(e).round(!0)(y);const c=o.selectAll("g").data(y.leaves()).join("g").attr("transform",r=>`translate(${r.x0},${r.y0})`).style("cursor","pointer"),d=r=>{const n=d3.color(r);return .2126*(n.r/255)+.7152*(n.g/255)+.0722*(n.b/255)>.6?"#002943":"#ffffff"},m=(r,n)=>{r.each(function(){const u=d3.select(this),p=u.text().split(/\s+/).reverse();let l,g=[],f=0;const D=1.1,b=u.attr("y");let w=u.text(null).append("tspan").attr("x",10).attr("y",b);for(;l=p.pop();)g.push(l),w.text(g.join(" ")),w.node().getComputedTextLength()>n&&(g.pop(),w.text(g.join(" ")),g=[l],w=u.append("tspan").attr("x",10).attr("y",b).attr("dy",`${++f*D}em`).text(l))})};c.each(function(r){const n=d3.select(this),u=a[r.data.name]||"#ccc",p=d(u),l=r.x1-r.x0,g=r.y1-r.y0;n.append("rect").attr("fill",u).attr("rx",10).attr("ry",10).attr("width",l).attr("height",g).style("transition","transform 0.25s ease, filter 0.25s ease").style("filter","drop-shadow(0 1px 2px rgba(0,0,0,0.05))"),n.on("mouseenter",()=>{n.raise().select("rect").style("transform","scale(1.05)").style("filter","drop-shadow(0 4px 8px rgba(0,0,0,0.15))")}).on("mouseleave",()=>{n.select("rect").style("transform","scale(1)").style("filter","drop-shadow(0 1px 2px rgba(0,0,0,0.05))")});const f=n.append("text").attr("x",10).attr("y",20).attr("fill",p).attr("font-size","13px").attr("font-weight",600).text(r.data.name).call(m,l-16);f.node().getBBox().height>g*.6&&f.style("display","none"),g>40&&l>80&&n.append("text").attr("x",l-10).attr("y",g-10).attr("text-anchor","end").attr("fill",p).attr("font-size","12px").text(`${r.data.percent.toFixed(2)}%`)})},q=()=>{const s=document.querySelector(".section_new");if(!s)return;const t=s.querySelector(".new_pin-height"),i=s.querySelector(".new_layout"),h=s.querySelectorAll(".new-paragraph_item");if(!t||!i||h.length===0)return;const e=Array.from(h).map(a=>new SplitText(a,{type:"words",wordsClass:"word",mask:"words"}));gsap.set(e.map(a=>a.words),{yPercent:100}),ScrollTrigger.create({trigger:t,start:"top top",end:"bottom bottom",pin:i});const o=gsap.timeline({scrollTrigger:{trigger:t,start:"top top",end:"bottom bottom",scrub:!0}});e.forEach((a,y)=>{o.to(a.words,{yPercent:0,duration:1,stagger:.2,ease:"power4.out"},y>0?"+=0.5":0)})},k=()=>{const s=document.querySelector(".section_word-break"),t=document.querySelector(".section_word-break .word-break-text"),i=new SplitText(t,{type:"words, chars",smartWrap:!0,wordsClass:"word",charsClass:"char"}),h=i.chars;i.words;const e=t.clientWidth-document.body.clientWidth,o=gsap.to(t,{x:-e,ease:"none",scrollTrigger:{trigger:".section_word-break .word-break_container",pin:!0,end:"+="+e,scrub:!0}});gsap.from(s,{ease:"power1.out",scrollTrigger:{trigger:".section_word-break .word-break_container",start:"top top",end:"+=200",scrub:!0}}),h.forEach(a=>{gsap.from(a,{yPercent:(Math.random()-.5)*400,rotation:(Math.random()-.5)*60,ease:"elastic.out(1.2, 1)",scrollTrigger:{trigger:a,containerAnimation:o,start:"left 90%",end:"left 10%",scrub:.5}})})};function _(){document.querySelectorAll("[data-highlight-text]").forEach(t=>{const i=t.getAttribute("data-highlight-scroll-start")||"top 90%",h=t.getAttribute("data-highlight-scroll-end")||"center 40%";t.getAttribute("data-highlight-fade");const e=t.getAttribute("data-highlight-stagger")||.1,o=t.getAttribute("data-highlight-bg")||"193, 230, 231";new SplitText(t,{type:"words",autoSplit:!0,onSplit(a){return gsap.context(()=>{const c=[];a.words.forEach(m=>{const r=document.createElement("div");r.className="highlight-word",m.parentNode.insertBefore(r,m),r.appendChild(m),c.push(r)});let d=gsap.timeline({scrollTrigger:{scrub:!0,trigger:t,start:i,end:h}});a.words.forEach((m,r)=>{const n=c[r],u=r*e;d.from(n,{backgroundColor:`rgba(${o}, 0)`,duration:.3,ease:"linear"},u).from(m,{opacity:0,duration:.2,ease:"linear"},u+.1).to(n,{backgroundColor:`rgba(${o}, 0)`,duration:.3,ease:"linear"},u+.4)})})}})})}gsap.registerPlugin(ScrollTrigger,Observer,SplitText,Draggable),x(),document.addEventListener("DOMContentLoaded",()=>{A(),S(),E(),C(),T(),q(),k(),_()})})();
