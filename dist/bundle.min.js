(function(){"use strict";const w=()=>{const a=new Lenis;return a.on("scroll",ScrollTrigger.update),gsap.ticker.add(t=>{a.raf(t*1e3)}),gsap.ticker.lagSmoothing(0),a},A=()=>{const a=document.querySelector(".section_home-header .home-header_wrapper"),t=a.clientWidth/2,u=gsap.utils.wrap(-t,0),y=gsap.quickTo(a,"x",{duration:1.5,ease:"power4",modifiers:{x:gsap.utils.unitize(u)}}),h=a.clientHeight/2,s=gsap.utils.wrap(-h,0),g=gsap.quickTo(a,"y",{duration:1.5,ease:"power4",modifiers:{y:gsap.utils.unitize(s)}});let p=0,c=0;Observer.create({target:window,type:"touch,pointer",onChangeX:l=>{p+=l.deltaX*2,y(p)},onChangeY:l=>{c+=l.deltaY*2,g(c)}})},E=()=>{document.querySelectorAll(".horizontal-scroll-section_wrapper").forEach(a=>{const t=a.querySelector(".horizontal-scroll-section_track"),u=()=>{a.style.height=`calc(${t.offsetWidth}px + 100vh)`};u(),ScrollTrigger.refresh(),window.addEventListener("resize",u),gsap.timeline({scrollTrigger:{trigger:a,start:"top top",end:"bottom bottom",scrub:!0},defaults:{ease:"none"}}).to(t,{xPercent:-100})})},b=()=>{document.querySelectorAll('[data-sticky-title="wrap"]').forEach(t=>{const u=Array.from(t.querySelectorAll('[data-sticky-title="heading"]')),y=gsap.timeline({scrollTrigger:{trigger:t,start:"top 40%",end:"bottom bottom",scrub:!0}}),h=.7,s=.7,g=.15;u.forEach((p,c)=>{p.setAttribute("aria-label",p.textContent);const l=new SplitText(p,{type:"words,chars"});l.words.forEach(n=>n.setAttribute("aria-hidden","true")),gsap.set(p,{visibility:"visible"});const m=gsap.timeline();m.from(l.chars,{autoAlpha:0,stagger:{amount:h,from:"start"},duration:h}),c<u.length-1&&m.to(l.chars,{autoAlpha:0,stagger:{amount:s,from:"end"},duration:s}),c===0?y.add(m):y.add(m,`-=${g}`)})})},C=()=>{const a=[{cause:"Education",count:396,percent:62.66},{cause:"Climate Action & Environment",count:385,percent:60.92},{cause:"Livelihood and Poverty Alleviation",count:350,percent:55.38},{cause:"Health",count:333,percent:52.69},{cause:"Employability",count:243,percent:38.45},{cause:"Gender",count:260,percent:41.14},{cause:"Financial Inclusion",count:232,percent:36.71},{cause:"Agriculture",count:226,percent:35.76},{cause:"Energy",count:193,percent:30.54},{cause:"Water & Sanitation & Hygiene",count:185,percent:29.27},{cause:"Nutrition",count:143,percent:22.63},{cause:"Arts & Culture",count:132,percent:20.89},{cause:"Governance",count:130,percent:20.57},{cause:"Conservation",count:129,percent:20.41},{cause:"Ageing",count:109,percent:17.25},{cause:"Affordable Housing",count:105,percent:16.61}],t=h=>getComputedStyle(document.documentElement).getPropertyValue(h).trim(),u={Education:t("--color-education"),"Climate Action & Environment":t("--color-climate"),"Livelihood and Poverty Alleviation":t("--color-livelihood"),Health:t("--color-health"),Employability:t("--color-employability"),Gender:t("--color-gender"),"Financial Inclusion":t("--color-financial-inclusion"),Agriculture:t("--color-agriculture"),Energy:t("--color-energy"),"Water & Sanitation & Hygiene":t("--color-water"),Nutrition:t("--color-nutrition"),"Arts & Culture":t("--color-arts"),Governance:t("--color-governance"),Conservation:t("--color-conservation"),Ageing:t("--color-aging"),"Affordable Housing":t("--color-affordable-housing")},y=()=>{const s=document.querySelector(".supported-chart").offsetWidth,g=s,p=s,c=s*.15;d3.select(".supported-chart svg").remove();const l=d3.select(".supported-chart").append("svg").attr("viewBox",`0 0 ${g} ${p}`).attr("preserveAspectRatio","xMidYMid meet").style("width","100%").style("height","100%").append("g").attr("transform",`translate(${g/2},${p/2})`),m=d3.pie().sort(null).value(1);d3.arc().innerRadius(c).outerRadius(o=>c+o.data.percent*s*.003).cornerRadius(10).padAngle(.03);const n=l.selectAll("path").data(m(a)).enter().append("path").attr("fill",o=>u[o.data.cause]||"#ccc").attr("d",d3.arc().innerRadius(c).outerRadius(c)).attr("stroke","#fff").attr("stroke-width",2).style("cursor","pointer");n.transition().delay((o,r)=>r*100).duration(800).ease(d3.easeCubicOut).attrTween("d",function(o){const r=d3.interpolate(c,c+o.data.percent*s*.003);return function(i){return d3.arc().innerRadius(c).outerRadius(r(i)).cornerRadius(10).padAngle(.03)(o)}});const e=l.append("g").attr("class","supported-chart_center-text").style("pointer-events","none");e.append("text").attr("class","center-cause").attr("y",-10).attr("opacity",0).style("font-size",`${s*.018}px`).style("font-weight","700").style("fill","#000"),e.append("text").attr("class","center-count").attr("y",s*.025).attr("opacity",0).style("font-size",`${s*.014}px`).style("fill","#000"),e.append("text").attr("class","center-percent").attr("y",s*.05).attr("opacity",0).style("font-size",`${s*.014}px`).style("font-weight","700").style("fill","#000"),n.on("mouseover",function(o,r){l.selectAll("path").transition().duration(200).style("opacity",.3),d3.select(this).transition().duration(200).style("opacity",1),e.select(".center-cause").text(r.data.cause).transition().duration(200).style("opacity",1),e.select(".center-count").text(`Count: ${r.data.count}`).transition().duration(200).style("opacity",1),e.select(".center-percent").text(`${r.data.percent.toFixed(2)}%`).transition().duration(200).style("opacity",1)}).on("mouseout",function(){l.selectAll("path").transition().duration(200).style("opacity",1),e.selectAll("text").transition().duration(200).style("opacity",0)}),document.querySelectorAll(".supported-chart_legend-color").forEach(o=>{const r=parseInt(o.dataset.index),i=a[r]?.cause;if(!i)return;const f=u[i];f&&(o.style.backgroundColor=f)});const d=l.selectAll("path");document.querySelectorAll(".supported-chart_legend-item").forEach(o=>{const r=parseInt(o.querySelector(".supported-chart_legend-color").dataset.index);o.addEventListener("mouseenter",()=>{d.transition().duration(200).style("opacity",.3),d3.select(d.nodes()[r]).transition().duration(200).style("opacity",1);const i=a[r];e.select(".center-cause").text(i.cause).transition().duration(200).style("opacity",1),e.select(".center-count").text(`Count: ${i.count}`).transition().duration(200).style("opacity",1),e.select(".center-percent").text(`${i.percent.toFixed(2)}%`).transition().duration(200).style("opacity",1)}),o.addEventListener("mouseleave",()=>{d.transition().duration(200).style("opacity",1),e.selectAll("text").transition().duration(200).style("opacity",0)})})};y(),window.addEventListener("resize",y)},S=()=>{const a={name:"Beneficiary Communities",children:[{name:"Children & youths",value:433,percent:68.48},{name:"Women & girls",value:413,percent:65.35},{name:"People in poverty",value:397,percent:62.82},{name:"Environment",value:306,percent:48.42},{name:"People without employment",value:257,percent:40.67},{name:"People with disabilities",value:208,percent:32.91},{name:"Elderly",value:198,percent:31.33},{name:"People with medical needs",value:198,percent:31.33},{name:"Ethnic minorities",value:182,percent:28.8},{name:"Immigrants & asylum seekers & refugees",value:112,percent:17.72},{name:"Offenders & re-offenders",value:47,percent:7.44}]},t=document.querySelector(".beneficiary-treemap"),u=t.clientWidth||1e3,y=t.clientHeight||600,h=8;t.innerHTML="";const s=d3.select(t).append("svg").attr("viewBox",[0,0,u,y]).style("width","100%").style("height","100%"),g={"Children & youths":"#00B3AD","Women & girls":"#F17C38","People in poverty":"#FED452",Environment:"#ADD5E0","People without employment":"#4AC1BE","People with disabilities":"#002943",Elderly:"#F59D6A","People with medical needs":"#FEE07E","Ethnic minorities":"#86D1D1","Immigrants & asylum seekers & refugees":"#80BDB4","Offenders & re-offenders":"#F2948C"},p=d3.hierarchy(a).sum(n=>n.value).sort((n,e)=>e.value-n.value);d3.treemap().tile(d3.treemapBinary).size([u,y]).paddingInner(h).round(!0)(p);const c=s.selectAll("g").data(p.leaves()).join("g").attr("transform",n=>`translate(${n.x0},${n.y0})`).style("cursor","pointer"),l=n=>{const e=d3.color(n);return .2126*(e.r/255)+.7152*(e.g/255)+.0722*(e.b/255)>.6?"#002943":"#ffffff"},m=(n,e)=>{n.each(function(){const d=d3.select(this),o=d.text().split(/\s+/).reverse();let r,i=[],f=0;const T=1.1,v=d.attr("y");let x=d.text(null).append("tspan").attr("x",10).attr("y",v);for(;r=o.pop();)i.push(r),x.text(i.join(" ")),x.node().getComputedTextLength()>e&&(i.pop(),x.text(i.join(" ")),i=[r],x=d.append("tspan").attr("x",10).attr("y",v).attr("dy",`${++f*T}em`).text(r))})};c.each(function(n){const e=d3.select(this),d=g[n.data.name]||"#ccc",o=l(d),r=n.x1-n.x0,i=n.y1-n.y0;e.append("rect").attr("fill",d).attr("rx",10).attr("ry",10).attr("width",r).attr("height",i).style("transition","transform 0.25s ease, filter 0.25s ease").style("filter","drop-shadow(0 1px 2px rgba(0,0,0,0.05))"),e.on("mouseenter",()=>{e.raise().select("rect").style("transform","scale(1.05)").style("filter","drop-shadow(0 4px 8px rgba(0,0,0,0.15))")}).on("mouseleave",()=>{e.select("rect").style("transform","scale(1)").style("filter","drop-shadow(0 1px 2px rgba(0,0,0,0.05))")});const f=e.append("text").attr("x",10).attr("y",20).attr("fill",o).attr("font-size","13px").attr("font-weight",600).text(n.data.name).call(m,r-16);f.node().getBBox().height>i*.6&&f.style("display","none"),i>40&&r>80&&e.append("text").attr("x",r-10).attr("y",i-10).attr("text-anchor","end").attr("fill",o).attr("font-size","12px").text(`${n.data.percent.toFixed(2)}%`)})};gsap.registerPlugin(ScrollTrigger,Observer,SplitText),w(),document.addEventListener("DOMContentLoaded",()=>{A(),E(),b(),C(),S()})})();
