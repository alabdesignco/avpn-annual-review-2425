(function(){"use strict";const v=()=>{const o=new Lenis;return o.on("scroll",ScrollTrigger.update),gsap.ticker.add(t=>{o.raf(t*1e3)}),gsap.ticker.lagSmoothing(0),o},b=(o="img")=>new Promise(t=>{imagesLoaded(document.querySelectorAll(o),{background:!0},t)}),A=()=>{if(!document.querySelector(".section_home-header .home-header_wrapper"))return;class t{constructor(){this.dom=document.querySelector(".section_home-header"),this.grid=document.querySelector(".home-header_wrapper"),this.products=[...document.querySelectorAll(".home-header_image-wrapper")],this.heading=document.querySelector(".home-header_heading"),this.navbar=document.querySelector(".navbar_component"),this.isDragging=!1}init(){this.intro()}intro(){this.centerGrid(),this.setupSplitText();const e=gsap.timeline();e.set(this.dom,{scale:.5}),e.set(this.products,{scale:.5,opacity:0}),e.set(this.navbar,{y:-100,autoAlpha:0}),e.from(this.headingChars,{yPercent:100,autoAlpha:0,duration:2,ease:"expo.inOut",stagger:.02}),e.to(this.products,{scale:1,opacity:1,duration:.6,ease:"power3.out",stagger:{amount:1.2,from:"random"}}),e.to(this.dom,{scale:1,duration:1.2,ease:"power3.inOut"}),e.to(this.navbar,{y:0,autoAlpha:1,duration:.8,ease:"power3.out"},"-=0.4"),e.call(()=>{this.setupDraggable(),this.addEvents(),this.observeProducts()})}setupSplitText(){this.heading&&(this.splitText=SplitText.create(this.heading,{type:"chars",mask:"chars"}),this.headingChars=this.splitText.chars)}centerGrid(){const e=this.grid.offsetWidth,r=this.grid.offsetHeight,a=window.innerWidth,p=window.innerHeight,g=(a-e)/2,h=(p-r)/2;gsap.set(this.grid,{x:g,y:h})}setupDraggable(){this.dom.classList.add("--is-loaded"),this.draggable=Draggable.create(this.grid,{type:"x,y",bounds:{minX:-(this.grid.offsetWidth-window.innerWidth)-200,maxX:200,minY:-(this.grid.offsetHeight-window.innerHeight)-100,maxY:100},inertia:!0,allowEventDefault:!0,edgeResistance:.9,onDragStart:()=>{this.isDragging=!0,this.grid.classList.add("--is-dragging")},onDragEnd:()=>{this.isDragging=!1,this.grid.classList.remove("--is-dragging")}})[0]}addEvents(){window.addEventListener("resize",()=>{this.updateBounds()})}updateBounds(){this.draggable&&(this.draggable.vars.bounds={minX:-(this.grid.offsetWidth-window.innerWidth)-50,maxX:50,minY:-(this.grid.offsetHeight-window.innerHeight)-50,maxY:50})}observeProducts(){const e=new IntersectionObserver(r=>{r.forEach(a=>{a.isIntersecting?gsap.to(a.target,{scale:1,opacity:1,duration:.5,ease:"power2.out"}):gsap.to(a.target,{opacity:0,scale:.5,duration:.5,ease:"power2.in"})})},{root:null,threshold:.1});this.products.forEach(r=>{e.observe(r)})}}const i=new t;b(".grid img").then(()=>{i.init(),document.body.classList.remove("loading")})},S=()=>{document.querySelectorAll(".horizontal-scroll-section_wrapper").forEach(o=>{const t=o.querySelector(".horizontal-scroll-section_track"),i=[1,2,3,4].map(r=>o.querySelector(`.foreword-content-accent_wrapper.is-${r}`)).filter(Boolean),d=()=>{o.style.height=`calc(${t.offsetWidth}px + 100vh)`};d(),ScrollTrigger.refresh(),window.addEventListener("resize",d),gsap.set(i,{scale:0,transformOrigin:"center"});const e=gsap.timeline({scrollTrigger:{trigger:o,start:"top top",end:"bottom bottom",scrub:!0},defaults:{ease:"power2.out"}});e.to(t,{xPercent:-100,ease:"none"},0),i.forEach((r,a)=>{const p=a/(i.length-1||1);e.to(r,{scale:1,duration:.3},p*.7)})})},E=()=>{document.querySelectorAll('[data-sticky-title="wrap"]').forEach(t=>{const i=Array.from(t.querySelectorAll('[data-sticky-title="heading"]')),d=gsap.timeline({scrollTrigger:{trigger:t,start:"top 40%",end:"bottom bottom",scrub:!0}}),e=.7,r=.7,a=.15;i.forEach((p,g)=>{p.setAttribute("aria-label",p.textContent);const h=new SplitText(p,{type:"words,chars"});h.words.forEach(s=>s.setAttribute("aria-hidden","true")),gsap.set(p,{visibility:"visible"});const y=gsap.timeline();y.from(h.chars,{autoAlpha:0,stagger:{amount:e,from:"start"},duration:e}),g<i.length-1&&y.to(h.chars,{autoAlpha:0,stagger:{amount:r,from:"end"},duration:r}),g===0?d.add(y):d.add(y,`-=${a}`)})})},C=()=>{const o=[{cause:"Education",count:396,percent:62.66},{cause:"Climate Action & Environment",count:385,percent:60.92},{cause:"Livelihood and Poverty Alleviation",count:350,percent:55.38},{cause:"Health",count:333,percent:52.69},{cause:"Employability",count:243,percent:38.45},{cause:"Gender",count:260,percent:41.14},{cause:"Financial Inclusion",count:232,percent:36.71},{cause:"Agriculture",count:226,percent:35.76},{cause:"Energy",count:193,percent:30.54},{cause:"Water & Sanitation & Hygiene",count:185,percent:29.27},{cause:"Nutrition",count:143,percent:22.63},{cause:"Arts & Culture",count:132,percent:20.89},{cause:"Governance",count:130,percent:20.57},{cause:"Conservation",count:129,percent:20.41},{cause:"Ageing",count:109,percent:17.25},{cause:"Affordable Housing",count:105,percent:16.61}],t=e=>getComputedStyle(document.documentElement).getPropertyValue(e).trim(),i={Education:t("--color-education"),"Climate Action & Environment":t("--color-climate"),"Livelihood and Poverty Alleviation":t("--color-livelihood"),Health:t("--color-health"),Employability:t("--color-employability"),Gender:t("--color-gender"),"Financial Inclusion":t("--color-financial-inclusion"),Agriculture:t("--color-agriculture"),Energy:t("--color-energy"),"Water & Sanitation & Hygiene":t("--color-water"),Nutrition:t("--color-nutrition"),"Arts & Culture":t("--color-arts"),Governance:t("--color-governance"),Conservation:t("--color-conservation"),Ageing:t("--color-aging"),"Affordable Housing":t("--color-affordable-housing")},d=()=>{const r=document.querySelector(".supported-chart").offsetWidth,a=r,p=r,g=r*.15;d3.select(".supported-chart svg").remove();const h=d3.select(".supported-chart").append("svg").attr("viewBox",`0 0 ${a} ${p}`).attr("preserveAspectRatio","xMidYMid meet").style("width","100%").style("height","100%").append("g").attr("transform",`translate(${a/2},${p/2})`),y=d3.pie().sort(null).value(1);d3.arc().innerRadius(g).outerRadius(l=>g+l.data.percent*r*.003).cornerRadius(10).padAngle(.03);const s=h.selectAll("path").data(y(o)).enter().append("path").attr("fill",l=>i[l.data.cause]||"#ccc").attr("d",d3.arc().innerRadius(g).outerRadius(g)).attr("stroke","#fff").attr("stroke-width",2).style("cursor","pointer");s.transition().delay((l,c)=>c*100).duration(800).ease(d3.easeCubicOut).attrTween("d",function(l){const c=d3.interpolate(g,g+l.data.percent*r*.003);return function(u){return d3.arc().innerRadius(g).outerRadius(c(u)).cornerRadius(10).padAngle(.03)(l)}});const n=h.append("g").attr("class","supported-chart_center-text").style("pointer-events","none");n.append("text").attr("class","center-cause").attr("y",-10).attr("opacity",0).style("font-size",`${r*.018}px`).style("font-weight","700").style("fill","#000"),n.append("text").attr("class","center-count").attr("y",r*.025).attr("opacity",0).style("font-size",`${r*.014}px`).style("fill","#000"),n.append("text").attr("class","center-percent").attr("y",r*.05).attr("opacity",0).style("font-size",`${r*.014}px`).style("font-weight","700").style("fill","#000"),s.on("mouseover",function(l,c){h.selectAll("path").transition().duration(200).style("opacity",.3),d3.select(this).transition().duration(200).style("opacity",1),n.select(".center-cause").text(c.data.cause).transition().duration(200).style("opacity",1),n.select(".center-count").text(`Count: ${c.data.count}`).transition().duration(200).style("opacity",1),n.select(".center-percent").text(`${c.data.percent.toFixed(2)}%`).transition().duration(200).style("opacity",1)}).on("mouseout",function(){h.selectAll("path").transition().duration(200).style("opacity",1),n.selectAll("text").transition().duration(200).style("opacity",0)}),document.querySelectorAll(".supported-chart_legend-color").forEach(l=>{const c=parseInt(l.dataset.index),u=o[c]?.cause;if(!u)return;const f=i[u];f&&(l.style.backgroundColor=f)});const m=h.selectAll("path");document.querySelectorAll(".supported-chart_legend-item").forEach(l=>{const c=parseInt(l.querySelector(".supported-chart_legend-color").dataset.index);l.addEventListener("mouseenter",()=>{m.transition().duration(200).style("opacity",.3),d3.select(m.nodes()[c]).transition().duration(200).style("opacity",1);const u=o[c];n.select(".center-cause").text(u.cause).transition().duration(200).style("opacity",1),n.select(".center-count").text(`Count: ${u.count}`).transition().duration(200).style("opacity",1),n.select(".center-percent").text(`${u.percent.toFixed(2)}%`).transition().duration(200).style("opacity",1)}),l.addEventListener("mouseleave",()=>{m.transition().duration(200).style("opacity",1),n.selectAll("text").transition().duration(200).style("opacity",0)})})};d(),window.addEventListener("resize",d)},T=()=>{const o={name:"Beneficiary Communities",children:[{name:"Children & youths",value:433,percent:68.48},{name:"Women & girls",value:413,percent:65.35},{name:"People in poverty",value:397,percent:62.82},{name:"Environment",value:306,percent:48.42},{name:"People without employment",value:257,percent:40.67},{name:"People with disabilities",value:208,percent:32.91},{name:"Elderly",value:198,percent:31.33},{name:"People with medical needs",value:198,percent:31.33},{name:"Ethnic minorities",value:182,percent:28.8},{name:"Immigrants & asylum seekers & refugees",value:112,percent:17.72},{name:"Offenders & re-offenders",value:47,percent:7.44}]},t=document.querySelector(".beneficiary-treemap"),i=t.clientWidth||1e3,d=t.clientHeight||600,e=8;t.innerHTML="";const r=d3.select(t).append("svg").attr("viewBox",[0,0,i,d]).style("width","100%").style("height","100%"),a={"Children & youths":"#00B3AD","Women & girls":"#F17C38","People in poverty":"#FED452",Environment:"#ADD5E0","People without employment":"#4AC1BE","People with disabilities":"#002943",Elderly:"#F59D6A","People with medical needs":"#FEE07E","Ethnic minorities":"#86D1D1","Immigrants & asylum seekers & refugees":"#80BDB4","Offenders & re-offenders":"#F2948C"},p=d3.hierarchy(o).sum(s=>s.value).sort((s,n)=>n.value-s.value);d3.treemap().tile(d3.treemapBinary).size([i,d]).paddingInner(e).round(!0)(p);const g=r.selectAll("g").data(p.leaves()).join("g").attr("transform",s=>`translate(${s.x0},${s.y0})`).style("cursor","pointer"),h=s=>{const n=d3.color(s);return .2126*(n.r/255)+.7152*(n.g/255)+.0722*(n.b/255)>.6?"#002943":"#ffffff"},y=(s,n)=>{s.each(function(){const m=d3.select(this),l=m.text().split(/\s+/).reverse();let c,u=[],f=0;const H=1.1,x=m.attr("y");let w=m.text(null).append("tspan").attr("x",10).attr("y",x);for(;c=l.pop();)u.push(c),w.text(u.join(" ")),w.node().getComputedTextLength()>n&&(u.pop(),w.text(u.join(" ")),u=[c],w=m.append("tspan").attr("x",10).attr("y",x).attr("dy",`${++f*H}em`).text(c))})};g.each(function(s){const n=d3.select(this),m=a[s.data.name]||"#ccc",l=h(m),c=s.x1-s.x0,u=s.y1-s.y0;n.append("rect").attr("fill",m).attr("rx",10).attr("ry",10).attr("width",c).attr("height",u).style("transition","transform 0.25s ease, filter 0.25s ease").style("filter","drop-shadow(0 1px 2px rgba(0,0,0,0.05))"),n.on("mouseenter",()=>{n.raise().select("rect").style("transform","scale(1.05)").style("filter","drop-shadow(0 4px 8px rgba(0,0,0,0.15))")}).on("mouseleave",()=>{n.select("rect").style("transform","scale(1)").style("filter","drop-shadow(0 1px 2px rgba(0,0,0,0.05))")});const f=n.append("text").attr("x",10).attr("y",20).attr("fill",l).attr("font-size","13px").attr("font-weight",600).text(s.data.name).call(y,c-16);f.node().getBBox().height>u*.6&&f.style("display","none"),u>40&&c>80&&n.append("text").attr("x",c-10).attr("y",u-10).attr("text-anchor","end").attr("fill",l).attr("font-size","12px").text(`${s.data.percent.toFixed(2)}%`)})},q=()=>{const o=document.querySelector(".section_new");if(!o)return;const t=o.querySelector(".new_pin-height"),i=o.querySelector(".new_layout"),d=o.querySelectorAll(".new-paragraph_item");if(!t||!i||d.length===0)return;const e=Array.from(d).map(a=>new SplitText(a,{type:"words",wordsClass:"word",mask:"words"}));gsap.set(e.map(a=>a.words),{yPercent:100}),ScrollTrigger.create({trigger:t,start:"top top",end:"bottom bottom",pin:i});const r=gsap.timeline({scrollTrigger:{trigger:t,start:"top top",end:"bottom bottom",scrub:!0}});e.forEach((a,p)=>{r.to(a.words,{yPercent:0,duration:1,stagger:.2,ease:"power4.out"},p>0?"+=0.5":0)})},_=()=>{const o=document.querySelector(".section_word-break"),t=document.querySelector(".section_word-break .word-break-text"),i=new SplitText(t,{type:"words, chars",smartWrap:!0,wordsClass:"word",charsClass:"char"}),d=i.chars;i.words;const e=t.clientWidth-document.body.clientWidth,r=gsap.to(t,{x:-e,ease:"none",scrollTrigger:{trigger:".section_word-break .word-break_container",pin:!0,end:"+="+e,scrub:!0}});gsap.from(o,{ease:"power1.out",scrollTrigger:{trigger:".section_word-break .word-break_container",start:"top top",end:"+=200",scrub:!0}}),d.forEach(a=>{gsap.from(a,{yPercent:(Math.random()-.5)*400,rotation:(Math.random()-.5)*60,ease:"elastic.out(1.2, 1)",scrollTrigger:{trigger:a,containerAnimation:r,start:"left 90%",end:"left 10%",scrub:.5}})})};function k(){document.querySelectorAll("[data-highlight-text]").forEach(t=>{const i=t.getAttribute("data-highlight-scroll-start")||"top 90%",d=t.getAttribute("data-highlight-scroll-end")||"center 40%",e=t.getAttribute("data-highlight-fade")||.2,r=t.getAttribute("data-highlight-stagger")||.1;new SplitText(t,{type:"words, chars",autoSplit:!0,onSplit(a){return gsap.context(()=>{gsap.timeline({scrollTrigger:{scrub:!0,trigger:t,start:i,end:d}}).from(a.chars,{autoAlpha:e,stagger:r,ease:"linear"})})}})})}gsap.registerPlugin(ScrollTrigger,Observer,SplitText,Draggable),v(),document.addEventListener("DOMContentLoaded",()=>{A(),S(),E(),C(),T(),q(),_(),k()})})();
